/** 
 * @file Core4.c
 * @generated by C6678CPrinter
 * @date Sun Apr 19 17:07:05 BST 2015
 */
 

#include "cores.h"
#include "utils.h"
#include "communication.h"
#include "fifo.h"
#include "cache.h"

// Core Global Declaration
extern char *const explode_generateTensors_arra__40;  // explode_generateTensors_arrayB > multiplyTensors_54 size:= 131072*char defined in Core0
extern char *const explode_generateTensors_arra__44;  // explode_generateTensors_arrayB > multiplyTensors_35 size:= 131072*char defined in Core0
extern char *const explode_transposeTensor_4_ou__2;  // explode_transposeTensor_4_output > multiplyTensors_35 size:= 131072*char defined in Core0
extern char *const explode_transposeTensor_6_ou__3;  // explode_transposeTensor_6_output > multiplyTensors_54 size:= 131072*char defined in Core0
extern char *const multiplyTensors_32__implode___0;  // multiplyTensors_32 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern char *const multiplyTensors_33__implode___0;  // multiplyTensors_33 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern char *const multiplyTensors_34__implode___0;  // multiplyTensors_34 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern int *const output_98304__arrayA__2;  // explode_transposeTensor_4_output_output_98304 > multiplyTensors_35_arrayA size:= 32768*int defined in Core0
extern int *const arrayB_1146880__arrayB__0;  // explode_generateTensors_arrayB_arrayB_1146880 > multiplyTensors_35_arrayB size:= 32768*int defined in Core0
extern long *const arrayC__input_786432__5;  // multiplyTensors_35_arrayC > implode_sumResults_4_input_input_786432 size:= 262144*long defined in Core0
extern char *const multiplyTensors_36__implode___0;  // multiplyTensors_36 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern char *const multiplyTensors_37__implode___0;  // multiplyTensors_37 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern char *const multiplyTensors_38__implode___0;  // multiplyTensors_38 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern char *const multiplyTensors_39__implode___0;  // multiplyTensors_39 > implode_sumResults_4_input size:= 1048576*char defined in Core0
extern int *const output_196608__arrayA__5;  // explode_transposeTensor_6_output_output_196608 > multiplyTensors_54_arrayA size:= 32768*int defined in Core0
extern int *const arrayB_1769472__arrayB__0;  // explode_generateTensors_arrayB_arrayB_1769472 > multiplyTensors_54_arrayB size:= 32768*int defined in Core0
extern long *const arrayC__input_1572864__2;  // multiplyTensors_54_arrayC > implode_sumResults_6_input_input_1572864 size:= 262144*long defined in Core0
extern char *const multiplyTensors_54__implode___0;  // multiplyTensors_54 > implode_sumResults_6_input size:= 1048576*char defined in Core0
extern long *const arrayC__input_0__2;  // multiplyTensors_32_arrayC > implode_sumResults_4_input_input_0 size:= 262144*long defined in Core0
extern long *const arrayC__input_262144__0;  // multiplyTensors_33_arrayC > implode_sumResults_4_input_input_262144 size:= 262144*long defined in Core0
extern long *const arrayC__input_524288__1;  // multiplyTensors_34_arrayC > implode_sumResults_4_input_input_524288 size:= 262144*long defined in Core0
extern long *const arrayC__input_1048576__4;  // multiplyTensors_36_arrayC > implode_sumResults_4_input_input_1048576 size:= 262144*long defined in Core0
extern long *const arrayC__input_1310720__6;  // multiplyTensors_37_arrayC > implode_sumResults_4_input_input_1310720 size:= 262144*long defined in Core0
extern long *const arrayC__input_1572864__3;  // multiplyTensors_38_arrayC > implode_sumResults_4_input_input_1572864 size:= 262144*long defined in Core0
extern long *const arrayC__input_1835008__1;  // multiplyTensors_39_arrayC > implode_sumResults_4_input_input_1835008 size:= 262144*long defined in Core0
extern long *const arrayC__input__3;  // implode_sumResults_4_input_arrayC > sumResults_4_input size:= 2097152*long defined in Core0
extern long *const output__arrayC_1048576__0;  // sumResults_4_output > implode_displayTensor_arrayC_arrayC_1048576 size:= 262144*long defined in Core0
extern char *const sumResults_4__implode_displa__0;  // sumResults_4 > implode_displayTensor_arrayC size:= 1048576*char defined in Core0

// Core Global Definitions

void core4(void){
	// Initialisation(s)
	communicationInit();

	// Begin the execution loop 
	while(1){
		busy_barrier();
		receiveStart(); // Core7 > Core4: explode_generateTensors_arra__40 
		receiveEnd(7); // Core7 > Core4: explode_generateTensors_arra__40 
		cache_inv(explode_generateTensors_arra__40, 131072*sizeof(char));
		receiveStart(); // Core7 > Core4: explode_generateTensors_arra__44 
		receiveEnd(7); // Core7 > Core4: explode_generateTensors_arra__44 
		cache_inv(explode_generateTensors_arra__44, 131072*sizeof(char));
		receiveStart(); // Core6 > Core4: explode_transposeTensor_4_ou__2 
		receiveEnd(6); // Core6 > Core4: explode_transposeTensor_4_ou__2 
		cache_inv(explode_transposeTensor_4_ou__2, 131072*sizeof(char));
		receiveStart(); // Core0 > Core4: explode_transposeTensor_6_ou__3 
		receiveEnd(0); // Core0 > Core4: explode_transposeTensor_6_ou__3 
		cache_inv(explode_transposeTensor_6_ou__3, 131072*sizeof(char));
		receiveStart(); // Core3 > Core4: multiplyTensors_32__implode___0 
		receiveEnd(3); // Core3 > Core4: multiplyTensors_32__implode___0 
		cache_inv(multiplyTensors_32__implode___0, 1048576*sizeof(char));
		receiveStart(); // Core5 > Core4: multiplyTensors_33__implode___0 
		receiveEnd(5); // Core5 > Core4: multiplyTensors_33__implode___0 
		cache_inv(multiplyTensors_33__implode___0, 1048576*sizeof(char));
		receiveStart(); // Core1 > Core4: multiplyTensors_34__implode___0 
		receiveEnd(1); // Core1 > Core4: multiplyTensors_34__implode___0 
		cache_inv(multiplyTensors_34__implode___0, 1048576*sizeof(char));
		multiply(512/*rowsA*/,512/*columnsA*/,8/*depthA*/,512/*rowsB*/,512/*columnsB*/,8/*depthB*/,output_98304__arrayA__2,arrayB_1146880__arrayB__0,arrayC__input_786432__5); // multiplyTensors_35
		cache_inv(output_98304__arrayA__2, 32768*sizeof(int));
		cache_inv(arrayB_1146880__arrayB__0, 32768*sizeof(int));
		receiveStart(); // Core2 > Core4: multiplyTensors_36__implode___0 
		receiveEnd(2); // Core2 > Core4: multiplyTensors_36__implode___0 
		cache_inv(multiplyTensors_36__implode___0, 1048576*sizeof(char));
		receiveStart(); // Core6 > Core4: multiplyTensors_37__implode___0 
		receiveEnd(6); // Core6 > Core4: multiplyTensors_37__implode___0 
		cache_inv(multiplyTensors_37__implode___0, 1048576*sizeof(char));
		receiveStart(); // Core0 > Core4: multiplyTensors_38__implode___0 
		receiveEnd(0); // Core0 > Core4: multiplyTensors_38__implode___0 
		cache_inv(multiplyTensors_38__implode___0, 1048576*sizeof(char));
		receiveStart(); // Core6 > Core4: multiplyTensors_39__implode___0 
		receiveEnd(6); // Core6 > Core4: multiplyTensors_39__implode___0 
		cache_inv(multiplyTensors_39__implode___0, 1048576*sizeof(char));
		multiply(512/*rowsA*/,512/*columnsA*/,8/*depthA*/,512/*rowsB*/,512/*columnsB*/,8/*depthB*/,output_196608__arrayA__5,arrayB_1769472__arrayB__0,arrayC__input_1572864__2); // multiplyTensors_54
		cache_inv(output_196608__arrayA__5, 32768*sizeof(int));
		cache_inv(arrayB_1769472__arrayB__0, 32768*sizeof(int));
		cache_wbInv(multiplyTensors_54__implode___0, 1048576*sizeof(char));
		sendStart(7); // Core4 > Core7: multiplyTensors_54__implode___0 
		sendEnd(); // Core4 > Core7: multiplyTensors_54__implode___0 
		// Join implode_sumResults_4_input
		{
			cache_wb(arrayC__input_0__2, 262144*sizeof(long));
			memcpy((void*)(arrayC__input__3+262144),(void*)( arrayC__input_262144__0+0), 262144*sizeof(long));
			cache_wb(arrayC__input_524288__1, 262144*sizeof(long));
			memcpy((void*)(arrayC__input__3+786432),(void*)( arrayC__input_786432__5+0), 262144*sizeof(long));
			cache_wb(arrayC__input_1048576__4, 262144*sizeof(long));
			memcpy((void*)(arrayC__input__3+1310720),(void*)( arrayC__input_1310720__6+0), 262144*sizeof(long));
			cache_wb(arrayC__input_1572864__3, 262144*sizeof(long));
			memcpy((void*)(arrayC__input__3+1835008),(void*)( arrayC__input_1835008__1+0), 262144*sizeof(long));
		}
		cache_wb(((char*)arrayC__input_0__2) + 0, 1048576);
		cache_inv(arrayC__input_0__2, 262144*sizeof(long));
		cache_inv(arrayC__input_262144__0, 262144*sizeof(long));
		cache_wb(((char*)arrayC__input_524288__1) + 0, 1048576);
		cache_inv(arrayC__input_524288__1, 262144*sizeof(long));
		cache_inv(arrayC__input_786432__5, 262144*sizeof(long));
		cache_wb(((char*)arrayC__input_1048576__4) + 0, 1048576);
		cache_inv(arrayC__input_1048576__4, 262144*sizeof(long));
		cache_inv(arrayC__input_1310720__6, 262144*sizeof(long));
		cache_wb(((char*)arrayC__input_1572864__3) + 0, 1048576);
		cache_inv(arrayC__input_1572864__3, 262144*sizeof(long));
		cache_inv(arrayC__input_1835008__1, 262144*sizeof(long));
		sum(512/*rowsA*/,512/*columnsB*/,8/*depthA*/,arrayC__input__3,output__arrayC_1048576__0); // sumResults_4
		cache_inv(arrayC__input__3, 2097152*sizeof(long));
		cache_wbInv(sumResults_4__implode_displa__0, 1048576*sizeof(char));
		sendStart(1); // Core4 > Core1: sumResults_4__implode_displa__0 
		sendEnd(); // Core4 > Core1: sumResults_4__implode_displa__0 
	}
}
